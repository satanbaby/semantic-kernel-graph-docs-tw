# åœ–å½¢æŒ‡æ¨™ç¯„ä¾‹

æœ¬ç¯„ä¾‹å±•ç¤ºå¦‚ä½•åœ¨èªç¾©æ ¸å¿ƒåœ–å½¢å·¥ä½œæµä¸­æ”¶é›†ã€ç›£æ§å’Œåˆ†ææ•ˆèƒ½æŒ‡æ¨™ã€‚å®ƒèªªæ˜å¦‚ä½•ç‚ºåœ–å½¢åŸ·è¡Œå¯¦æ–½å…¨é¢çš„å¯è§€æ¸¬æ€§ï¼ŒåŒ…æ‹¬ç¯€é»ç´šæŒ‡æ¨™ã€åŸ·è¡Œè·¯å¾‘å’Œæ•ˆèƒ½åˆ†æã€‚

## ç›®æ¨™

å­¸ç¿’å¦‚ä½•åœ¨åŸºæ–¼åœ–å½¢çš„å·¥ä½œæµä¸­å¯¦æ–½å…¨é¢çš„æŒ‡æ¨™å’Œç›£æ§ï¼Œä»¥ä¾¿ï¼š
* åœ¨åœ–å½¢åŸ·è¡ŒæœŸé–“æ”¶é›†å³æ™‚æ•ˆèƒ½æŒ‡æ¨™
* ç›£æ§ç¯€é»åŸ·è¡Œæ™‚é–“ã€æˆåŠŸç‡å’Œè³‡æºä½¿ç”¨
* åˆ†æåŸ·è¡Œè·¯å¾‘ä¸¦è­˜åˆ¥æ•ˆèƒ½ç“¶é ¸
* å°‡æŒ‡æ¨™åŒ¯å‡ºåˆ°å„ç¨®ç›£æ§ç³»çµ±å’Œå„€è¡¨æ¿
* ç‚ºç”Ÿç”¢å·¥ä½œæµå¯¦æ–½è‡ªè¨‚æŒ‡æ¨™å’Œå‘Šè­¦

## å…ˆæ±ºæ¢ä»¶

* **.NET 8.0** æˆ–æ›´é«˜ç‰ˆæœ¬
* **OpenAI API å¯†é‘°**é…ç½®åœ¨ `appsettings.json`
* **èªç¾©æ ¸å¿ƒåœ–å½¢å¥—ä»¶**å·²å®‰è£
* åŸºæœ¬äº†è§£[åœ–å½¢æ¦‚å¿µ](../concepts/graph-concepts.md)å’Œ[æŒ‡æ¨™æ¦‚å¿µ](../concepts/metrics.md)

## ä¸»è¦å…ƒä»¶

### æ¦‚å¿µå’ŒæŠ€è¡“

* **æ•ˆèƒ½æŒ‡æ¨™**ï¼šåŸ·è¡Œæ•ˆèƒ½è³‡æ–™çš„æ”¶é›†å’Œåˆ†æ
* **ç¯€é»ç›£æ§**ï¼šå€‹åˆ¥ç¯€é»åŸ·è¡Œçš„å³æ™‚ç›£æ§
* **åŸ·è¡Œè·¯å¾‘åˆ†æ**ï¼šè¿½è¹¤å’Œåˆ†æé€éåœ–å½¢çš„åŸ·è¡Œæµç¨‹
* **è³‡æºç›£æ§**ï¼šç›£æ§ CPUã€è¨˜æ†¶é«”å’Œå…¶ä»–è³‡æºä½¿ç”¨
* **æŒ‡æ¨™åŒ¯å‡º**ï¼šå°‡æŒ‡æ¨™åŒ¯å‡ºåˆ°ç›£æ§ç³»çµ±å’Œå„€è¡¨æ¿

### æ ¸å¿ƒé¡åˆ¥

* `GraphPerformanceMetrics`ï¼šæ ¸å¿ƒæŒ‡æ¨™æ”¶é›†å’Œç®¡ç†
* `NodeExecutionMetrics`ï¼šå€‹åˆ¥ç¯€é»æ•ˆèƒ½è¿½è¹¤
* `MetricsDashboard`ï¼šå³æ™‚æŒ‡æ¨™è¦–è¦ºåŒ–å’Œåˆ†æ
* `GraphMetricsExporter`ï¼šå°‡æŒ‡æ¨™åŒ¯å‡ºåˆ°å¤–éƒ¨ç³»çµ±

## åŸ·è¡Œç¯„ä¾‹

### é–‹å§‹ä½¿ç”¨

æ­¤ç¯„ä¾‹å±•ç¤ºä½¿ç”¨èªç¾©æ ¸å¿ƒåœ–å½¢å¥—ä»¶çš„æŒ‡æ¨™æ”¶é›†å’Œæ•ˆèƒ½ç›£æ§ã€‚ä¸‹é¢çš„ç¨‹å¼ç¢¼ç‰‡æ®µèªªæ˜å¦‚ä½•åœ¨è‡ªå·±çš„æ‡‰ç”¨ç¨‹å¼ä¸­å¯¦æ–½æ­¤æ¨¡å¼ã€‚

## é€æ­¥å¯¦æ–½

### 1. åŸºæœ¬æŒ‡æ¨™æ”¶é›†

æ­¤ç¯„ä¾‹å±•ç¤ºåœ–å½¢åŸ·è¡ŒæœŸé–“çš„åŸºæœ¬æŒ‡æ¨™æ”¶é›†ã€‚

```csharp
// å»ºç«‹é–‹ç™¼å‹å–„çš„æŒ‡æ¨™é¸é …ï¼ˆç¤ºç¯„ç”¨çŸ­é–“éš”ï¼‰
var options = GraphMetricsOptions.CreateDevelopmentOptions();
options.EnableResourceMonitoring = false; // ä¿æŒç¤ºç¯„ç¢ºå®šæ€§

// ä½¿ç”¨é¸é …å»ºç«‹æŒ‡æ¨™æ”¶é›†å™¨
using var metrics = new GraphPerformanceMetrics(options);

// æ¨¡æ“¬å¹¾å€‹ç¯€é»åŸ·è¡Œä¸¦ç‚ºæ¯å€‹è¨˜éŒ„æŒ‡æ¨™
for (int i = 0; i < 5; i++)
{
    var execId = $"exec-{i}";

    // é–‹å§‹è¿½è¹¤ç¯€é»åŸ·è¡Œ
    var tracker = metrics.StartNodeTracking($"node-{i}", $"node-name-{i}", execId);

    // æ¨¡æ“¬å·¥ä½œ
    await Task.Delay(10 + i * 5);

    // æ¨™è¨˜å®Œæˆä¸¦è¨˜éŒ„åŸ·è¡Œè·¯å¾‘ä»¥ä¾›åˆ†æ
    metrics.CompleteNodeTracking(tracker, success: true, result: null);
    metrics.RecordExecutionPath(execId, new[] { tracker.NodeId }, TimeSpan.FromMilliseconds(10 + i * 5), success: true);
}

// ä½¿ç”¨æŒ‡æ¨™åŒ¯å‡ºå™¨åŒ¯å‡ºé è¦½
using var exporter = new GraphMetricsExporter();
var json = exporter.ExportMetrics(metrics, MetricsExportFormat.Json, TimeSpan.FromMinutes(10));
Console.WriteLine("\n--- JSON åŒ¯å‡ºé è¦½ ---\n");
Console.WriteLine(json.Substring(0, Math.Min(800, json.Length)));

var prometheus = exporter.ExportMetrics(metrics, MetricsExportFormat.Prometheus, TimeSpan.FromMinutes(10));
Console.WriteLine("\n--- Prometheus åŒ¯å‡ºé è¦½ ---\n");
Console.WriteLine(prometheus.Substring(0, Math.Min(800, prometheus.Length)));
```

### 2. é€²éšæ•ˆèƒ½ç›£æ§

å±•ç¤ºå…·æœ‰è©³ç´°æŒ‡æ¨™æ”¶é›†çš„å…¨é¢æ•ˆèƒ½ç›£æ§ã€‚

```csharp
// å»ºç«‹é–‹ç™¼é¸é …å’Œé©åˆé€²è¡Œåˆ†æç¤ºç¯„çš„æŒ‡æ¨™æ”¶é›†å™¨
var options = GraphMetricsOptions.CreateDevelopmentOptions();
using var metrics = new GraphPerformanceMetrics(options);

// æ¨¡æ“¬æ˜‚è²´çš„æ“ä½œä¸¦è¨˜éŒ„è©³ç´°çš„è¨ˆæ™‚è³‡è¨Š
var execId = "advanced-exec-1";
var tracker = metrics.StartNodeTracking("performance-node", "performance-node", execId);
var stopwatch = System.Diagnostics.Stopwatch.StartNew();

// æ¨¡æ“¬ CPU ç¹é‡çš„å·¥ä½œï¼Œå¶çˆ¾ç­‰å¾…ä»¥é¿å…å°é–åŸ·è¡Œç·’æ± 
int iterations = 10_000;
long result = 0;
for (int i = 0; i < iterations; i++)
{
    result += i * i;
    if (i % 1000 == 0) await Task.Delay(1); // å”ä½œæš«åœä»¥ä¿æŒå›æ‡‰æ€§
}

stopwatch.Stop();
metrics.CompleteNodeTracking(tracker, success: true, result: result);

// ä½¿ç”¨åŒ¯å‡ºå™¨åœ¨æ¨¡æ“¬å·¥ä½œè² è¼‰å¾Œæª¢æŸ¥æŒ‡æ¨™
using var exporter = new GraphMetricsExporter();
Console.WriteLine(exporter.ExportMetrics(metrics, MetricsExportFormat.Json, TimeSpan.FromMinutes(10)));
```

### 3. å³æ™‚æŒ‡æ¨™å„€è¡¨æ¿

å±•ç¤ºå¦‚ä½•å¯¦æ–½å³æ™‚æŒ‡æ¨™è¦–è¦ºåŒ–å’Œç›£æ§ã€‚

```csharp
// ä½¿ç”¨æŒ‡æ¨™æ”¶é›†å™¨çš„è³‡æºæ¡æ¨£å±•ç¤ºåŸºæœ¬çš„å³æ™‚æ¡æ¨£
var options = GraphMetricsOptions.CreateDevelopmentOptions();
options.EnableResourceMonitoring = true;
using var metrics = new GraphPerformanceMetrics(options);

// æ¨¡æ“¬ä¸€é€£ä¸²çš„çŸ­åŸ·è¡Œä¸¦é¡¯ç¤ºæ¡æ¨£çš„ CPU/è¨˜æ†¶é«”
for (int i = 0; i < 10; i++)
{
    var execId = $"rt-{i}";
    var tracker = metrics.StartNodeTracking("data-generator", "data-generator", execId);

    // æ¨¡æ“¬ä¸€äº›è™•ç†å»¶é²
    await Task.Delay(Random.Shared.Next(50, 200));

    metrics.CompleteNodeTracking(tracker, success: true);

    // è®€å–ç›®å‰æ¡æ¨£çš„ç³»çµ±æŒ‡æ¨™ï¼ˆæ”¶é›†å™¨å®šæœŸæ›´æ–°å®ƒå€‘ï¼‰
    Console.WriteLine($"è¿­ä»£ {i + 1}ï¼šCPU={metrics.CurrentCpuUsage:F1}% è¨˜æ†¶é«”={metrics.CurrentAvailableMemoryMB:F0} MB");

    await Task.Delay(500); // ç¯€æµæ›´æ–°ä»¥é€²è¡Œç¤ºç¯„
}

Console.WriteLine("âœ… å³æ™‚æ¡æ¨£ç¤ºç¯„å®Œæˆ");
```

### 4. æŒ‡æ¨™åŒ¯å‡ºå’Œæ•´åˆ

å±•ç¤ºå°‡æŒ‡æ¨™åŒ¯å‡ºåˆ°å¤–éƒ¨ç›£æ§ç³»çµ±å’Œå„€è¡¨æ¿ã€‚

```csharp
// ä½¿ç”¨æŒ‡æ¨™åŒ¯å‡ºå™¨ç›´æ¥åŒ¯å‡ºç¯„ä¾‹
using var exporter = new GraphMetricsExporter(new GraphMetricsExportOptions { IndentedOutput = true });

// åŒ¯å‡º JSON
var jsonExport = exporter.ExportMetrics(metrics, MetricsExportFormat.Json, TimeSpan.FromMinutes(10));
Console.WriteLine("--- JSON åŒ¯å‡º ---");
Console.WriteLine(jsonExport);

// åŒ¯å‡º CSV
var csvExport = exporter.ExportMetrics(metrics, MetricsExportFormat.Csv, TimeSpan.FromMinutes(10));
Console.WriteLine("--- CSV åŒ¯å‡º ---");
Console.WriteLine(csvExport.Split('\n').Take(20)); // é è¦½å‰å¹¾è¡Œ

// åŒ¯å‡º Prometheus
var promExport = exporter.ExportMetrics(metrics, MetricsExportFormat.Prometheus, TimeSpan.FromMinutes(10));
Console.WriteLine("--- Prometheus åŒ¯å‡º ---");
Console.WriteLine(promExport);
```

## é æœŸè¼¸å‡º

### åŸºæœ¬æŒ‡æ¨™æ”¶é›†ç¯„ä¾‹

```
ğŸ“Š æ¸¬è©¦æŒ‡æ¨™æ”¶é›†ï¼šç¯„ä¾‹è³‡æ–™ 1
   è™•ç†æ™‚é–“ï¼š234.56 æ¯«ç§’
   è¼¸å…¥å¤§å°ï¼š12 å€‹å­—å…ƒ
   æ”¶é›†çš„æŒ‡æ¨™ï¼š5 å€‹æŒ‡æ¨™

ğŸ“Š æ¸¬è©¦æŒ‡æ¨™æ”¶é›†ï¼šç¯„ä¾‹è³‡æ–™ 2
   è™•ç†æ™‚é–“ï¼š187.23 æ¯«ç§’
   è¼¸å…¥å¤§å°ï¼š12 å€‹å­—å…ƒ
   æ”¶é›†çš„æŒ‡æ¨™ï¼š5 å€‹æŒ‡æ¨™
```

### é€²éšæ•ˆèƒ½ç›£æ§ç¯„ä¾‹

```
ğŸš€ æ¸¬è©¦æ•ˆèƒ½ç›£æ§ï¼šä½è¤‡é›œåº¦ä»»å‹™
   è¤‡é›œåº¦ç´šåˆ¥ï¼š1
   è™•ç†æ™‚é–“ï¼š156.78 æ¯«ç§’
   è¿­ä»£æ¬¡æ•¸ï¼š1,000
   ååé‡ï¼š6,374 æ¬¡/ç§’
   æ•ˆèƒ½åˆ†æ•¸ï¼š85.67
   ç“¶é ¸ï¼šCPU ç¹é‡

ğŸš€ æ¸¬è©¦æ•ˆèƒ½ç›£æ§ï¼šé«˜è¤‡é›œåº¦ä»»å‹™
   è¤‡é›œåº¦ç´šåˆ¥ï¼š10
   è™•ç†æ™‚é–“ï¼š1,234.56 æ¯«ç§’
   è¿­ä»£æ¬¡æ•¸ï¼š10,000
   ååé‡ï¼š8,101 æ¬¡/ç§’
   æ•ˆèƒ½åˆ†æ•¸ï¼š92.34
   ç“¶é ¸ï¼šè¨˜æ†¶é«”ç¹é‡
```

### å³æ™‚æŒ‡æ¨™å„€è¡¨æ¿ç¯„ä¾‹

```
ğŸ“Š é–‹å§‹å³æ™‚æŒ‡æ¨™æ”¶é›†...
   å„€è¡¨æ¿æ¯ 500 æ¯«ç§’æ›´æ–°ä¸€æ¬¡
   æŒ‰ä»»æ„éµåœæ­¢...
   è¿­ä»£ 1ï¼šç›®å‰ï¼š87.45ã€å¹³å‡ï¼š87.45ã€è¶¨å‹¢ï¼šç©©å®š
   è¿­ä»£ 2ï¼šç›®å‰ï¼š112.34ã€å¹³å‡ï¼š99.90ã€è¶¨å‹¢ï¼šä¸Šå‡
   è¿­ä»£ 3ï¼šç›®å‰ï¼š95.67ã€å¹³å‡ï¼š98.49ã€è¶¨å‹¢ï¼šä¸‹é™
âœ… å³æ™‚æŒ‡æ¨™æ”¶é›†å®Œæˆ
```

### æŒ‡æ¨™åŒ¯å‡ºç¯„ä¾‹

```
ğŸ“¤ æ¸¬è©¦æŒ‡æ¨™åŒ¯å‡ºï¼š10 å€‹åŸ·è¡Œ
   æˆåŠŸç‡ï¼š90.0%
   å¹³å‡æ™‚é–“ï¼š150.00 æ¯«ç§’
   åŒ¯å‡ºæ ¼å¼ï¼šjsonã€csvã€prometheusã€monitoring

ğŸ“¤ æ¸¬è©¦æŒ‡æ¨™åŒ¯å‡ºï¼š50 å€‹åŸ·è¡Œ
   æˆåŠŸç‡ï¼š96.0%
   å¹³å‡æ™‚é–“ï¼š150.00 æ¯«ç§’
   åŒ¯å‡ºæ ¼å¼ï¼šjsonã€csvã€prometheusã€monitoring
```

## çµ„æ…‹é¸é …

### æŒ‡æ¨™çµ„æ…‹

```csharp
var metricsOptions = new GraphMetricsOptions
{
    EnableNodeMetrics = true,                        // å•Ÿç”¨ç¯€é»ç´šæŒ‡æ¨™
    EnableExecutionMetrics = true,                   // å•Ÿç”¨åŸ·è¡Œç´šæŒ‡æ¨™
    EnableResourceMetrics = true,                    // å•Ÿç”¨è³‡æºä½¿ç”¨æŒ‡æ¨™
    EnableCustomMetrics = true,                      // å•Ÿç”¨è‡ªè¨‚æŒ‡æ¨™
    EnablePerformanceProfiling = true,               // å•Ÿç”¨æ•ˆèƒ½åˆ†æ
    EnableRealTimeMetrics = true,                    // å•Ÿç”¨å³æ™‚æŒ‡æ¨™
    EnableMetricsStreaming = true,                   // å•Ÿç”¨æŒ‡æ¨™ä¸²æµ
    EnableMetricsDashboard = true,                   // å•Ÿç”¨æŒ‡æ¨™å„€è¡¨æ¿
    EnableMetricsExport = true,                      // å•Ÿç”¨æŒ‡æ¨™åŒ¯å‡º
    EnableMetricsPersistence = true,                 // å•Ÿç”¨æŒ‡æ¨™æŒä¹…åŒ–
    MetricsCollectionInterval = TimeSpan.FromMilliseconds(100), // æ”¶é›†é–“éš”
    DashboardUpdateInterval = TimeSpan.FromMilliseconds(500),   // å„€è¡¨æ¿æ›´æ–°é–“éš”
    ExportInterval = TimeSpan.FromSeconds(5),        // åŒ¯å‡ºé–“éš”
    MetricsStoragePath = "./metrics-data",           // æŒ‡æ¨™å„²å­˜è·¯å¾‘
    ExportFormats = new[] { "json", "csv", "prometheus" },     // åŒ¯å‡ºæ ¼å¼
    EnableMetricsCompression = true,                 // å•Ÿç”¨æŒ‡æ¨™å£“ç¸®
    MaxMetricsHistory = 10000,                       // æœ€å¤§æŒ‡æ¨™æ­·å²è¨˜éŒ„
    EnableMetricsAggregation = true,                 // å•Ÿç”¨æŒ‡æ¨™èšåˆ
    AggregationInterval = TimeSpan.FromMinutes(1)    // èšåˆé–“éš”
};
```

### æ•ˆèƒ½åˆ†æçµ„æ…‹

```csharp
var profilingOptions = new PerformanceProfilingOptions
{
    EnableDetailedProfiling = true,                  // å•Ÿç”¨è©³ç´°åˆ†æ
    EnableMemoryProfiling = true,                    // å•Ÿç”¨è¨˜æ†¶é«”åˆ†æ
    EnableCpuProfiling = true,                       // å•Ÿç”¨ CPU åˆ†æ
    EnableNetworkProfiling = true,                   // å•Ÿç”¨ç¶²è·¯åˆ†æ
    ProfilingSamplingRate = 0.1,                     // åˆ†ææ¡æ¨£ç‡ (10%)
    EnableHotPathAnalysis = true,                    // å•Ÿç”¨ç†±è·¯å¾‘åˆ†æ
    EnableBottleneckDetection = true,                // å•Ÿç”¨ç“¶é ¸åµæ¸¬
    ProfilingOutputPath = "./profiling-data",         // åˆ†æè¼¸å‡ºè·¯å¾‘
    EnableProfilingVisualization = true,             // å•Ÿç”¨åˆ†æè¦–è¦ºåŒ–
    MaxProfilingDataSize = 100 * 1024 * 1024        // æœ€å¤§åˆ†æè³‡æ–™å¤§å° (100MB)
};
```

## ç–‘é›£æ’è§£

### å¸¸è¦‹å•é¡Œ

#### æœªæ”¶é›†æŒ‡æ¨™
```bash
# å•é¡Œï¼šæœªæ”¶é›†æŒ‡æ¨™
# è§£æ±ºæ–¹æ¡ˆï¼šå•Ÿç”¨æŒ‡æ¨™æ”¶é›†ä¸¦æª¢æŸ¥çµ„æ…‹
EnableNodeMetrics = true;
EnableExecutionMetrics = true;
MetricsCollectionInterval = TimeSpan.FromMilliseconds(100);
```

#### æ•ˆèƒ½å½±éŸ¿
```bash
# å•é¡Œï¼šæŒ‡æ¨™æ”¶é›†å½±éŸ¿æ•ˆèƒ½
# è§£æ±ºæ–¹æ¡ˆï¼šèª¿æ•´æ”¶é›†é–“éš”ä¸¦å•Ÿç”¨æ¡æ¨£
MetricsCollectionInterval = TimeSpan.FromSeconds(1);
EnableMetricsSampling = true;
SamplingRate = 0.1; // 10% æ¡æ¨£
```

#### è¨˜æ†¶é«”å•é¡Œ
```bash
# å•é¡Œï¼šæŒ‡æ¨™æ¶ˆè€—éå¤šè¨˜æ†¶é«”
# è§£æ±ºæ–¹æ¡ˆï¼šå•Ÿç”¨å£“ç¸®ä¸¦é™åˆ¶æ­·å²è¨˜éŒ„
EnableMetricsCompression = true;
MaxMetricsHistory = 1000;
EnableMetricsAggregation = true;
```

### é™¤éŒ¯æ¨¡å¼

å•Ÿç”¨è©³ç´°è¨˜éŒ„ä»¥é€²è¡Œç–‘é›£æ’è§£ï¼š

```csharp
// å•Ÿç”¨é™¤éŒ¯è¨˜éŒ„
var logger = LoggerFactory.Create(builder =>
{
    builder.AddConsole();
    builder.SetMinimumLevel(LogLevel.Debug);
}).CreateLogger<GraphMetricsExample>();

// ä»¥é™¤éŒ¯è¨˜éŒ„çµ„æ…‹æŒ‡æ¨™
var debugMetricsOptions = new GraphMetricsOptions
{
    EnableNodeMetrics = true,
    EnableExecutionMetrics = true,
    EnableResourceMetrics = true,
    EnableDebugLogging = true,
    LogMetricsCollection = true,
    LogMetricsExport = true
};
```

## é€²éšæ¨¡å¼

### è‡ªè¨‚æŒ‡æ¨™æ”¶é›†

```csharp
// å¯¦æ–½è‡ªè¨‚æŒ‡æ¨™æ”¶é›†
public class CustomMetricsCollector : IMetricsCollector
{
    public async Task<Dictionary<string, object>> CollectMetricsAsync(MetricsContext context)
    {
        var customMetrics = new Dictionary<string, object>();
        
        // æ”¶é›†è‡ªè¨‚æ¥­å‹™æŒ‡æ¨™
        customMetrics["business_value"] = await CalculateBusinessValue(context);
        customMetrics["user_satisfaction"] = await MeasureUserSatisfaction(context);
        customMetrics["cost_per_execution"] = await CalculateCostPerExecution(context);
        
        // æ”¶é›†é ˜åŸŸç‰¹å®šæŒ‡æ¨™
        customMetrics["domain_accuracy"] = await MeasureDomainAccuracy(context);
        customMetrics["processing_efficiency"] = await MeasureProcessingEfficiency(context);
        
        return customMetrics;
    }
}
```

### æŒ‡æ¨™èšåˆå’Œåˆ†æ

```csharp
// å¯¦æ–½è‡ªè¨‚æŒ‡æ¨™èšåˆ
public class MetricsAggregator : IMetricsAggregator
{
    public async Task<AggregatedMetrics> AggregateMetricsAsync(IEnumerable<MetricsSnapshot> snapshots)
    {
        var aggregated = new AggregatedMetrics();
        
        foreach (var snapshot in snapshots)
        {
            // èšåˆæ•ˆèƒ½æŒ‡æ¨™
            aggregated.TotalExecutions += snapshot.ExecutionCount;
            aggregated.TotalProcessingTime += snapshot.TotalProcessingTime;
            aggregated.SuccessCount += snapshot.SuccessCount;
            aggregated.ErrorCount += snapshot.ErrorCount;
            
            // è¿½è¹¤è¶¨å‹¢
            aggregated.ExecutionTrends.Add(snapshot.Timestamp, snapshot.ExecutionCount);
            aggregated.PerformanceTrends.Add(snapshot.Timestamp, snapshot.AverageProcessingTime);
        }
        
        // è¨ˆç®—è¡ç”ŸæŒ‡æ¨™
        aggregated.SuccessRate = (double)aggregated.SuccessCount / aggregated.TotalExecutions;
        aggregated.AverageProcessingTime = aggregated.TotalProcessingTime / aggregated.TotalExecutions;
        aggregated.ErrorRate = (double)aggregated.ErrorCount / aggregated.TotalExecutions;
        
        return aggregated;
    }
}
```

### å³æ™‚å‘Šè­¦

```csharp
// å¯¦æ–½å³æ™‚æŒ‡æ¨™å‘Šè­¦
public class MetricsAlerting : IMetricsAlerting
{
    private readonly List<AlertRule> _alertRules;
    
    public async Task<List<Alert>> CheckAlertsAsync(MetricsSnapshot metrics)
    {
        var alerts = new List<Alert>();
        
        foreach (var rule in _alertRules)
        {
            if (await rule.EvaluateAsync(metrics))
            {
                alerts.Add(new Alert
                {
                    RuleId = rule.RuleId,
                    Severity = rule.Severity,
                    Message = rule.GenerateMessage(metrics),
                    Timestamp = DateTime.UtcNow,
                    Metrics = metrics
                });
            }
        }
        
        return alerts;
    }
}

// å‘Šè­¦è¦å‰‡ç¯„ä¾‹
public class AlertRule
{
    public string RuleId { get; set; }
    public AlertSeverity Severity { get; set; }
    public Func<MetricsSnapshot, Task<bool>> Condition { get; set; }
    
    public static AlertRule CreateHighErrorRateRule()
    {
        return new AlertRule
        {
            RuleId = "high_error_rate",
            Severity = AlertSeverity.Critical,
            Condition = async (metrics) => metrics.ErrorRate > 0.1 // 10% éŒ¯èª¤ç‡
        };
    }
}
```

## ç›¸é—œç¯„ä¾‹

* [åœ–å½¢è¦–è¦ºåŒ–](./graph-visualization.md)ï¼šæŒ‡æ¨™çš„è¦–è¦ºè¡¨ç¤º
* [æ•ˆèƒ½æœ€ä½³åŒ–](./performance-optimization.md)ï¼šä½¿ç”¨æŒ‡æ¨™é€²è¡Œæœ€ä½³åŒ–
* [ä¸²æµåŸ·è¡Œ](./streaming-execution.md)ï¼šå³æ™‚æŒ‡æ¨™ä¸²æµ
* [é™¤éŒ¯å’Œæª¢æŸ¥](./debug-inspection.md)ï¼šç”¨æ–¼é™¤éŒ¯çš„æŒ‡æ¨™

## å¦è«‹åƒé–±

* [æŒ‡æ¨™å’Œå¯è§€æ¸¬æ€§](../concepts/metrics.md)ï¼šç†è§£æŒ‡æ¨™æ¦‚å¿µ
* [æ•ˆèƒ½ç›£æ§](../how-to/performance-monitoring.md)ï¼šæ•ˆèƒ½ç›£æ§æ¨¡å¼
* [é™¤éŒ¯å’Œæª¢æŸ¥](../how-to/debug-and-inspection.md)ï¼šä½¿ç”¨æŒ‡æ¨™é€²è¡Œé™¤éŒ¯
* [API åƒè€ƒ](../api/)ï¼šå®Œæ•´ API æ–‡ä»¶
